<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§»åŠ¨ç«¯æ£€æµ‹ - TongBlog</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        h1 { margin-bottom: 20px; font-size: 24px; }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            background: rgba(255,255,255,0.15);
        }
        .status.success { background: rgba(34,197,94,0.3); }
        .status.error { background: rgba(239,68,68,0.3); }
        .status.warning { background: rgba(251,191,36,0.3); }
        .info { font-size: 14px; margin: 5px 0; }
        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: white;
            color: #667eea;
            text-decoration: none;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: bold;
            transition: transform 0.2s;
        }
        .btn:active { transform: scale(0.95); }
        #results { margin-top: 20px; }
        .loading { 
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” TongBlog ç§»åŠ¨ç«¯è¯Šæ–­</h1>
        
        <div class="status">
            <div class="info"><strong>è®¾å¤‡ç±»å‹ï¼š</strong><span id="deviceType"></span></div>
            <div class="info"><strong>æµè§ˆå™¨ï¼š</strong><span id="browser"></span></div>
            <div class="info"><strong>å±å¹•å°ºå¯¸ï¼š</strong><span id="screenSize"></span></div>
            <div class="info"><strong>ç½‘ç»œçŠ¶æ€ï¼š</strong><span id="network"></span></div>
        </div>

        <div id="results"></div>

        <a href="/" class="btn">è¿”å›é¦–é¡µ</a>
        <a href="#" class="btn" onclick="location.reload(); return false;">é‡æ–°æ£€æµ‹</a>
    </div>

    <script>
        // æ£€æµ‹è®¾å¤‡ä¿¡æ¯
        const ua = navigator.userAgent;
        const isMobile = /iPhone|iPad|iPod|Android|Mobile/i.test(ua);
        const isIOS = /iPhone|iPad|iPod/i.test(ua);
        const isAndroid = /Android/i.test(ua);
        const isWeChat = /MicroMessenger/i.test(ua);
        
        document.getElementById('deviceType').textContent = 
            isMobile ? (isIOS ? 'iOS' : isAndroid ? 'Android' : 'ç§»åŠ¨è®¾å¤‡') : 'æ¡Œé¢è®¾å¤‡';
        
        // æ£€æµ‹æµè§ˆå™¨
        let browserName = 'æœªçŸ¥';
        if (isWeChat) browserName = 'å¾®ä¿¡æµè§ˆå™¨';
        else if (/Chrome/i.test(ua)) browserName = 'Chrome';
        else if (/Safari/i.test(ua)) browserName = 'Safari';
        else if (/Firefox/i.test(ua)) browserName = 'Firefox';
        document.getElementById('browser').textContent = browserName;
        
        // å±å¹•ä¿¡æ¯
        document.getElementById('screenSize').textContent = 
            `${window.innerWidth} Ã— ${window.innerHeight}`;
        
        // ç½‘ç»œçŠ¶æ€
        const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
        const networkType = connection ? connection.effectiveType : 'æœªçŸ¥';
        document.getElementById('network').textContent = navigator.onLine ? 
            `åœ¨çº¿ (${networkType})` : 'ç¦»çº¿';

        // å¼€å§‹æ£€æµ‹
        const results = document.getElementById('results');
        
        async function runTests() {
            const tests = [
                {
                    name: 'ä¸»é¡µè®¿é—®æµ‹è¯•',
                    url: '/',
                    critical: true
                },
                {
                    name: 'å­—ä½“åŠ è½½æµ‹è¯•',
                    url: '/fonts/å‰é¡µå¤§å­—ä½“ç®€.ttf',
                    critical: false
                },
                {
                    name: 'KaTeX CSS åŠ è½½æµ‹è¯•',
                    url: 'https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css',
                    critical: false
                },
                {
                    name: 'Twikoo è¯„è®ºæµ‹è¯•',
                    url: 'https://cdn.jsdelivr.net/npm/twikoo@1.6.44/dist/twikoo.min.js',
                    critical: false
                }
            ];

            for (const test of tests) {
                const statusDiv = document.createElement('div');
                statusDiv.className = 'status';
                statusDiv.innerHTML = `
                    <div class="info">
                        <strong>${test.name}ï¼š</strong>
                        <span class="loading"></span> æ£€æµ‹ä¸­...
                    </div>
                `;
                results.appendChild(statusDiv);

                try {
                    const startTime = performance.now();
                    const response = await fetch(test.url, { 
                        method: 'HEAD',
                        cache: 'no-cache'
                    });
                    const endTime = performance.now();
                    const duration = Math.round(endTime - startTime);

                    if (response.ok) {
                        statusDiv.className = 'status success';
                        statusDiv.innerHTML = `
                            <div class="info">
                                <strong>${test.name}ï¼š</strong>âœ… æ­£å¸¸ (${duration}ms)
                            </div>
                        `;
                    } else {
                        statusDiv.className = test.critical ? 'status error' : 'status warning';
                        statusDiv.innerHTML = `
                            <div class="info">
                                <strong>${test.name}ï¼š</strong>
                                ${test.critical ? 'âŒ' : 'âš ï¸'} 
                                å¤±è´¥ (HTTP ${response.status})
                            </div>
                        `;
                    }
                } catch (error) {
                    statusDiv.className = test.critical ? 'status error' : 'status warning';
                    statusDiv.innerHTML = `
                        <div class="info">
                            <strong>${test.name}ï¼š</strong>
                            ${test.critical ? 'âŒ' : 'âš ï¸'} 
                            ${error.message}
                        </div>
                    `;
                }
            }

            // æ€»ç»“
            const summaryDiv = document.createElement('div');
            summaryDiv.className = 'status';
            summaryDiv.innerHTML = `
                <div class="info">
                    <strong>è¯Šæ–­å®Œæˆ</strong><br>
                    å¦‚æœä¸»é¡µè®¿é—®æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜ã€‚<br>
                    å…¶ä»–èµ„æºåŠ è½½å¤±è´¥ä¸å½±å“åŸºæœ¬æµè§ˆã€‚
                </div>
            `;
            results.appendChild(summaryDiv);
        }

        runTests();
    </script>
</body>
</html>
